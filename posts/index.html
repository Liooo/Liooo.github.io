
<!DOCTYPE HTML>

<html>

<head>
	<meta charset="utf-8">
	<title>All Posts - Ryo&#8217;s Engieer Blog</title>
	<meta name="author" content="Ryo Yamada">

	
	<meta name="description" content="All Posts Rails E2E Test Environment by Rspec, Turnip, Capybara, Selenium and Poltergeist Instruction to set up a Rails E2E test environment, which &hellip;">
	

  <!-- http://t.co/dKP3o1e -->
  <meta name="HandheldFriendly" content="True">
  <meta name="MobileOptimized" content="320">
  <meta name="viewport" content="width=device-width, initial-scale=1">

	<link href="/atom.xml" rel="alternate" title="Ryo's Engieer Blog" type="application/atom+xml">
	
	<link rel="canonical" href="http://liooo.github.io/posts/">
	<link href="/favicon.png" rel="shortcut icon">
	<link href="/stylesheets/screen.css" media="screen, projection" rel="stylesheet" type="text/css">
	<link href="/stylesheets/font-awesome.min.css" media="screen, projection" rel="stylesheet" type="text/css">
	<!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
	<link href='http://fonts.googleapis.com/css?family=Nunito:400,300,700' rel='stylesheet' type='text/css'>
	<script src="//ajax.googleapis.com/ajax/libs/jquery/1.7.2/jquery.min.js"></script>
	
  
	<script type="text/javascript">
		var _gaq = _gaq || [];
		_gaq.push(['_setAccount', 'UA-52638400-2']);
		_gaq.push(['_trackPageview']);

		(function() {
			var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
			ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
			var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
		})();
	</script>


</head>


<body>
	<div class="container">
		<div class="left-col">
			<div class="intrude-less">
			<header id="header" class="inner"><div class="profilepic">
	
	<script src="/javascripts/md5.js"></script>
	<script type="text/javascript">
		$(function(){
			$('.profilepic').append("<img src='http://www.gravatar.com/avatar/" + MD5("ryoyamada3@gmail.com") + "?s=160' alt='Profile Picture' style='width: 85px;' />");
		});
	</script>
	
</div>

<h1 class="author"><a href="/">Ryo Yamada</a></h1>

<a class="lang" href="/jp">→ Japanese Page (Not much ready yet)</a>


<nav id="main-nav"><ul class="main">
    <li><a href="/">Blog</a></li>
    <li><a href="/about">About</a></li>
    <li><a href="/publications">Publications</a></li>
</ul>
</nav>
<nav id="sub-nav"><div class="social">
    
    
    
        <a class="twitter" href="http://twitter.com/rio_mt_af" title="Twitter" target="_blank">Twitter</a>
    
    
        <a class="github" href="https://github.com/Liooo" title="GitHub" target="_blank">GitHub</a>
    
    
    
      <a class="stackoverflow" href="http://stackoverflow.com/users/1330926/ryo" title="StackOverflow" target="_blank"></a>
    
    
    
    
    
    
    
    
    
    
    <a class="rss" href="/atom.xml" title="RSS" target="_blank">RSS</a>
    
</div>
</nav>

<div class="header-section">
    <a href='/blog/tags/bdd' style='font-size: 130.0%'>BDD(1)</a> <a href='/blog/tags/capybara' style='font-size: 130.0%'>Capybara(1)</a> <a href='/blog/tags/guard' style='font-size: 130.0%'>guard(1)</a> <a href='/blog/tags/iterm2' style='font-size: 130.0%'>iTerm2(1)</a> <a href='/blog/tags/phantomjs' style='font-size: 130.0%'>PhantomJS(1)</a> <a href='/blog/tags/poltergeist' style='font-size: 130.0%'>Poltergeist(1)</a> <a href='/blog/tags/rspec' style='font-size: 130.0%'>Rspec(1)</a> <a href='/blog/tags/ruby' style='font-size: 130.0%'>Ruby(1)</a> <a href='/blog/tags/ruby-on-rails' style='font-size: 160.0%'>Ruby on Rails(2)</a> <a href='/blog/tags/selenium' style='font-size: 130.0%'>Selenium(1)</a> <a href='/blog/tags/turnip' style='font-size: 130.0%'>Turnip(1)</a> <a href='/blog/tags/vim' style='font-size: 130.0%'>Vim(1)</a> 
</div>

</header>				
			</div>
		</div>	
		<div class="mid-col">
			
				
			
			<div class="mid-col-container">
				<div id="content" class="inner"><div class="all-posts">
  <div class="container">
    <div class="row">
      <div class="list-title col-md-offset-3 col-md-6">
        <h4>All Posts</h4>
      </div>
    </div>
  </div>

  <div class="article-list">
    <div class="container">
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article class="blog-index">
  <h2><a href="/blog/2015/02/13/rails-e2e-test-environment-by-rspec-turnip-capybara-selenium-and-poltergeist/">Rails E2E Test Environment by Rspec, Turnip, Capybara, Selenium and Poltergeist</a></h2>
  
  <p>
    <p>Instruction to set up a Rails E2E test environment, which covers Google Chrome, FireFox and PhantomJS as test browsers.</p>

<p>See <a href="https://github.com/Liooo/rails4_turnip_capybara_selenium_poltergeist">Liooo/rails4_turnip_capybara_selenium_poltergeist</a> for the complete app.</p>


  </p>
  <span class="meta">
    written 








  


<time datetime="2015-02-13T12:52:09+09:00" data-updated="true" itemprop="datePublished"></time>
    


	<a class='tag' href='/blog/tags/bdd/'>BDD</a>, <a class='tag' href='/blog/tags/capybara/'>Capybara</a>, <a class='tag' href='/blog/tags/phantomjs/'>PhantomJS</a>, <a class='tag' href='/blog/tags/poltergeist/'>Poltergeist</a>, <a class='tag' href='/blog/tags/rspec/'>Rspec</a>, <a class='tag' href='/blog/tags/ruby-on-rails/'>Ruby on Rails</a>, <a class='tag' href='/blog/tags/selenium/'>Selenium</a>, <a class='tag' href='/blog/tags/turnip/'>Turnip</a>, <a class='tag' href='/blog/tags/guard/'>guard</a>



  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2015/02/13/rails-e2e-test-environment-by-rspec-turnip-capybara-selenium-and-poltergeist/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article class="blog-index">
  <h2><a href="/blog/2014/11/28/east-asian-multibyte-character-piles-up-in-vim-slash-iterm2-slash-os-x-environment/">East Asian Multibyte Character Piles Up in Vim/iTerm2/OS X Environment</a></h2>
  
  <p>
    <p><img src="/images/20141128/characters_piling_up.png" alt="characters pililng up" /></p>

<p>Multibyte characters were piling up to each other in my vim on iTerm2 like above.</p>

<p>Here’s how to fix this.</p>

<h3 id="vim-setting">vim setting</h3>
<p>Add the following line to .vimrc</p>

<div class="bogus-wrapper"><notextile><figure class="code"><figcaption><span>~/.vimrc</span></figcaption><div class="highlight"><table><tr><td class="gutter"><pre class="line-numbers"><span class="line-number">1</span>
</pre></td><td class="code"><pre><code class="sh"><span class="line"><span class="nb">set </span><span class="nv">ambiwidth</span><span class="o">=</span>double
</span></code></pre></td></tr></table></div></figure></notextile></div>

<p>It’s telling vim to double the width of characters having <a href="http://www.unicode.org/reports/tr11/#Ambiguous">Ambiguous Character Width</a>.</p>

<h3 id="iterm2-setting">iTerm2 setting</h3>

<p>Tick the checkbox and tell iTerm2 to do the same. </p>

<p><img src="/images/20141128/iTerm2_setting.png" alt="iTerm2" /></p>

<p>That’s it, fixed!</p>

<p><img src="/images/20141128/fixed.png" alt="fixed" /></p>

  </p>
  <span class="meta">
    written 








  


<time datetime="2014-11-28T17:38:47+09:00" data-updated="true" itemprop="datePublished"></time>
    


	<a class='tag' href='/blog/tags/vim/'>Vim</a>, <a class='tag' href='/blog/tags/iterm2/'>iTerm2</a>



  </span>

  
</article>

        </div>
      </div>
      
      
      <div class="row">
        <div class="col-md-offset-3 col-md-6">
          <article class="blog-index">
  <h2><a href="/blog/2014/11/22/building-multiple-file-upload-form-in-rails-way/">Building Form for Multiple File Upload in Rails Way</a></h2>
  
  <p>
    <ul id="markdown-toc">
  <li><a href="#background">Background</a></li>
  <li><a href="#gems-to-use">Gems to Use</a>    <ul>
      <li><a href="#carrierwave">CarrierWave</a></li>
      <li><a href="#cocoon">Cocoon</a></li>
    </ul>
  </li>
  <li><a href="#instruction">Instruction</a>    <ul>
      <li><a href="#scaffolding-the-app">Scaffolding the App</a></li>
      <li><a href="#form-for-hasmany-relation-with-cocoon">Form for has_many relation with Cocoon</a></li>
      <li><a href="#showing-thumbnail">Showing Thumbnail</a></li>
      <li><a href="#redisplaying-thumbnail-on-validation-fail">Redisplaying thumbnail on validation fail</a></li>
      <li><a href="#rejecting-empty-photo-fields">Rejecting Empty Photo Fields</a></li>
    </ul>
  </li>
</ul>

<h3 id="background">Background</h3>
<p>When you build a form in “Rails way”, you don’t have to do much on your own.
It automatically validates the parameter, and re-renders the form with proper messages in the event of errors.</p>

<p>However, when it comes to file upload form, things get complicated.
For instance, when the form is redisplayed because of the form error, the file input value is lost.
You don’t want to make users select the same file again, just because they mistyped their email address or phone number. Especially when they chose
a bunch of files to upload. It’s also bad in terms of website performance (We don’t want them to send large image files again and again).</p>

<p>We could use javascript file upload plugins (lots of them are opensource, cool, well animated and fantastic). But they normally make source code difficult to manage
if you’ve been doing things in “Rails way”.</p>

<p>Here I’ll introduce a way to build a file upload form in “Rails way”, which gets along with Rails activeform and requires minimum effort to build, but still does enough.
Concretely,</p>

<ul>
  <li>Uploads multiple files at a time.</li>
  <li>Can add/remove multiple file input fields dynamically.</li>
  <li>Shows preview when an image file is chosen.</li>
  <li>If an errors exist in the form, the file inputs memorize and redisplay the selected file.</li>
  <li>Also, the server caches the once-uploaded-file in the event of form redisplay, so no additional network traffic occurs.</li>
  <li>Can remove existing files.</li>
  <li>Use plain html form, NOT xhr (therefore, no file drag and drop feature).</li>
</ul>

<p>See <a href="https://github.com/Liooo/carrierwave-cocoon-file-upload-app-demo">Github Repository</a> for the complete app.</p>


  </p>
  <span class="meta">
    written 








  


<time datetime="2014-11-22T16:32:05+09:00" data-updated="true" itemprop="datePublished"></time>
    


	<a class='tag' href='/blog/tags/ruby/'>Ruby</a>, <a class='tag' href='/blog/tags/ruby-on-rails/'>Ruby on Rails</a>



  </span>

  
    <a class="full-article-link pull-right" rel="full-article" href="/blog/2014/11/22/building-multiple-file-upload-form-in-rails-way/">Read on &rarr;</a>
  
</article>

        </div>
      </div>
      
    </div>
  </div>
</div>
</div>
			</div>
			<footer id="footer" class="inner">Copyright &copy; 2015

    Ryo Yamada


</footer>
		</div>
	</div>
	

<script type="text/javascript">
      var disqus_shortname = 'liooo-github-io';
      
        
        var disqus_script = 'count.js';
      
    (function () {
      var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
      dsq.src = 'http://' + disqus_shortname + '.disqus.com/' + disqus_script;
      (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    }());
</script>



<div id="fb-root"></div>
<script>(function(d, s, id) {
  var js, fjs = d.getElementsByTagName(s)[0];
  if (d.getElementById(id)) {return;}
  js = d.createElement(s); js.id = id; js.async = true;
  js.src = "//connect.facebook.net/en_US/all.js#appId=212934732101925&xfbml=1";
  fjs.parentNode.insertBefore(js, fjs);
}(document, 'script', 'facebook-jssdk'));</script>



  <script type="text/javascript">
    (function() {
      var script = document.createElement('script'); script.type = 'text/javascript'; script.async = true;
      script.src = 'https://apis.google.com/js/plusone.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(script, s);
    })();
  </script>



  <script type="text/javascript">
    (function(){
      var twitterWidgets = document.createElement('script');
      twitterWidgets.type = 'text/javascript';
      twitterWidgets.async = true;
      twitterWidgets.src = '//platform.twitter.com/widgets.js';
      document.getElementsByTagName('head')[0].appendChild(twitterWidgets);
    })();
  </script>




</body>
</html>
